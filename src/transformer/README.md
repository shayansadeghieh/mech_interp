Other than using jaxtyping and `einops.einsum`, this is 100% from Neel Nanda's gpt2 [tutorial](https://www.youtube.com/watch?v=dsjUDacBw8o&t=257s). 

![alt text](assets/transformer.png)